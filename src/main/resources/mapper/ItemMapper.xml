<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.green.campingsmore.item.ItemMapper">
    <insert id="insItem">
        INSERT INTO item
        SET iitem_category = #{iitemCategory},
            name = #{name},
            price = #{price},
            pic = #{pic}
    </insert>

    <insert id="insCate">
        INSERT INTO item_category
        SET name = #{categoryName}
    </insert>

    <select id="selCategory" resultType="ItemSelCateVo">
        SELECT iitem_category iitemCategory, `name`
        FROM item_category
        order BY `name` DESC
    </select>

    <select id="selDetail" resultType="ItemSelDetailVo">
        SELECT  A.iitem,A.`name`, A.pic, A.`name`, A.price, A.created_at createdAt, A.info, GROUP_CONCAT(B.pic) picList
        FROM item A, item_detail_pic B
        WHERE A.iitem = #{iitem}
    </select>

    <select id="selCateItem" resultType="ItemVo">
        SELECT iitem, name, pic, price, created_at createdAt
        FROM item
        WHERE iitem_category = #{iitemCategory}
        AND del_yn = 1
        ORDER BY created_at DESC
        LIMIT ${startIdx}, ${row}
    </select>

    <insert id="insBestItem">
        INSERT INTO best_item
        SET iitem = #{iitem},
        month_like = #{monthLike}
    </insert>


    <select id="selBestItem" resultType="ItemVo">
        SELECT iitem, name, pic, price, created_at createdAt
        FROM best_item
        WHERE month_like =
        ORDER BY iitem_category DESC
    </select>


    <select id="selIcate" resultType="Long">
        SELECT iitem_category iitemCategory FROM item_category
        WHERE name = #{categoryName}
    </select>

    <delete id="delDetailPic">
        DELETE FROM item_detail_pic
        WHERE iitem = #{iitem}
    </delete>

    <insert id="insDetailPic">
        INSERT INTO item_detail_pic
        SET iitem = #{iitem},
        pic = #{pic}
    </insert>


</mapper>